<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Grafik Total Produk per Bulan</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
</head>
<body style="font-family: Arial; padding: 20px;">
  <h2>Grafik Total Produk di Masingâ€‘masing Bulan</h2><canvas id="chart" style="width:100%; height:400px"></canvas>

  <script>
    // Fetch CSV dari GitHub Pages (file wajib bernama data.csv)
    fetch('data.csv')
      .then(r => r.text())
      .then(csv => processCSV(csv))
      .catch(err => alert('Gagal membaca CSV: ' + err));

    function processCSV(text) {
      // Split baris
      const rows = text.trim().split(/
?
/);

      // Pisah kolom dengan ; (sesuai file Anda)
      const data = rows.map(r => r.split(';'));

      // Index kolom bulan (berdasarkan file Anda: Jan=1, Feb=2, ... Dec=12)
      const monthIndex = {
        Jan: 1, Feb: 2, Mar: 3, Apr: 4, May: 5,
        Jun: 6, Jul: 7, Aug: 8, Sep: 9, Oct: 10, Nov: 11, Dec: 12
      };

      // Ambil header
      const header = data[1];

      // Dapatkan posisi real tiap bulan di CSV
      const monthCols = {};
      for (const m in monthIndex) {
        monthCols[m] = header.indexOf(m);
      }

      // Hitung total per bulan
      const totals = {
        Jan: 0, Feb: 0, Mar: 0, Apr: 0, May: 0, Jun: 0,
        Jul: 0, Aug: 0, Sep: 0, Oct: 0, Nov: 0, Dec: 0
      };

      // Loop baris data dari row 2 hingga akhir
      for (let i = 2; i < data.length; i++) {
        const row = data[i];

        for (const m in totals) {
          const col = monthCols[m];
          if (col >= 0 && row[col] !== undefined) {
            const val = parseFloat(row[col].replace(',', '.'));
            if (!isNaN(val)) totals[m] += val;
          }
        }
      }

      drawChart(totals);
    }

    function drawChart(totals) {
      const labels = Object.keys(totals);
      const values = Object.values(totals);

      new Chart(document.getElementById('chart'), {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'Total Produk',
            data: values,
            backgroundColor: labels.map(() => `hsl(${Math.random()*360},70%,55%)`)
          }]
        },
        options: {
          responsive: true,
          scales: {
            y: { beginAtZero: true }
          }
        }
      });
    }
  </script></body>
</html>
