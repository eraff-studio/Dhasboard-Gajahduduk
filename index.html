<!DOCTYPE html>
<html>
<head>
    <title>Grafik Total Qty Per Bulan</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<h2>Grafik Total Qty Per Bulan (Warna Biru)</h2>

<canvas id="grafikBar" width="400" height="200"></canvas>

<script>
    // Paksa bulan muncul (Jan–Dec)
    const monthNames = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
    let totals = monthNames.reduce((acc, m) => ({...acc, [m]: 0}), {});

    // Coba ambil data CSV (jika ada)
    fetch("data.csv")
        .then(response => response.text())
        .then(csv => {
            const rows = csv.trim().split(/\r?\n/).slice(1);

            rows.forEach(row => {
                if (row.trim() === "") return;

                const cols = row.split(";");

                const tanggal = cols[1];
                const qty = parseInt(cols[4]);

                if (!tanggal || isNaN(qty)) return;

                const monthIndex = new Date(tanggal).getMonth();
                const bulan = monthNames[monthIndex];

                totals[bulan] += qty;
            });

            tampilkanGrafik();
        })
        .catch(() => {
            // Jika file tidak ada → tetap buat grafik kosong warna biru
            tampilkanGrafik();
        });

    function tampilkanGrafik() {
        const ctx = document.getElementById("grafikBar").getContext("2d");

        new Chart(ctx, {
            type: "bar",
            data: {
                labels: monthNames,
                datasets: [{
                    label: "Total Qty",
                    data: monthNames.map(m => totals[m]),
                    backgroundColor: "blue",
                    borderColor: "blue",
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: { beginAtZero: true }
                }
            }
        });
    }
</script>

</body>
</html>
