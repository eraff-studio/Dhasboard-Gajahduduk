<!DOCTYPE html>
<html>
<head>
    <title>Grafik Total Qty Per Bulan</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<h2>Grafik Total Qty Per Bulan 12</h2>

<canvas id="grafikBar" width="400" height="200"></canvas>

<script>
    fetch("data.csv")
        .then(response => response.text())
        .then(csv => {
            const rows = csv.trim().split(/\r?\n/).slice(1);

            const monthNames = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
            let totals = monthNames.reduce((acc, m) => ({...acc, [m]: 0}), {});

            rows.forEach(row => {
                if (row.trim() === "") return;

                const cols = row.split(";");  // pemisah ;

                const tanggal = cols[1];
                const qty = parseInt(cols[4]);

                if (!tanggal || isNaN(qty)) return;

                const monthIndex = new Date(tanggal).getMonth(); // 0â€“11
                const bulan = monthNames[monthIndex];

                totals[bulan] += qty;
            });

            const ctx = document.getElementById("grafikBar").getContext("2d");

            new Chart(ctx, {
                type: "bar",
                data: {
                    labels: monthNames,
                    datasets: [{
                        label: "Total Qty per Bulan",
                        data: monthNames.map(m => totals[m]),
                        backgroundColor: monthNames.map(() =>
                            `hsl(${Math.random()*360},70%,55%)`
                        ),
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: { beginAtZero: true }
                    }
                }
            });
        });
</script>

</body>
</html>
